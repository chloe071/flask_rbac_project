{% extends "base.html" %}
{% block content %}
<h1 class="mt-4">{{ 'Edit Playbook' if playbook else 'Create New Playbook' }}</h1>

<form method="POST" class="mt-3">
    <div class="mb-3">
        <label for="name" class="form-label">Playbook Name</label>
        <input type="text" id="name" name="name" class="form-control" required value="{{ playbook.name if playbook else '' }}">
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description (optional)</label>
        <textarea id="description" name="description" class="form-control" rows="3">{{ playbook.description if playbook else '' }}</textarea>
    </div>

    <div class="mb-3">
        <label for="json_data" class="form-label">Playbook JSON</label>
        <textarea id="json_data" name="json_data" class="form-control" rows="10" required>{{ playbook.json_data if playbook else '{\n  \n}' }}</textarea>
    </div>

    <button type="submit" class="btn btn-primary">{{ 'Update' if playbook else 'Create' }}</button>
</form>

<script>
// Optional: Add basic JSON validation
document.querySelector('form').addEventListener('submit', function(event) {
    const jsonText = document.getElementById('json_data').value;
    try {
        JSON.parse(jsonText);
    } catch (e) {
        alert('Invalid JSON: ' + e.message);
        event.preventDefault();
    }
});
</script>

{% endblock %}